{"root":{"data":{"text":"Transformers 微调 (以文本分类为例)"},"children":[{"data":{"text":"一、整体目标"},"children":[{"data":{"text":"使用预训练模型 (如 BERT、RoBERTa 等)"},"children":[]},{"data":{"text":"在自己的分类数据集上微调"},"children":[]},{"data":{"text":"得到可以做情感分析/垃圾邮件识别/主题分类的模型"},"children":[]}]},{"data":{"text":"二、模型与任务"},"children":[{"data":{"text":"任务类型"},"children":[{"data":{"text":"二分类 (正/负、垃圾/正常)"},"children":[]},{"data":{"text":"多分类 (多种情感、多种主题)"},"children":[]}]},{"data":{"text":"模型选择"},"children":[{"data":{"text":"从 Hub 选模型名称 (如 bert-base-uncased)"},"children":[]},{"data":{"text":"使用 AutoModelForSequenceClassification 加载"},"children":[]},{"data":{"text":"同步加载 AutoTokenizer"},"children":[]}]}]},{"data":{"text":"三、数据与标注"},"children":[{"data":{"text":"数据来源"},"children":[{"data":{"text":"本地 CSV/JSON"},"children":[]},{"data":{"text":"datasets 库内置数据或自定义数据集"},"children":[]}]},{"data":{"text":"数据字段"},"children":[{"data":{"text":"文本字段：text、sentence 等"},"children":[]},{"data":{"text":"标签字段：label (整数 id)"},"children":[]}]},{"data":{"text":"数据划分"},"children":[{"data":{"text":"训练集：用于更新参数"},"children":[]},{"data":{"text":"验证集/测试集：用于评估模型"},"children":[]}]}]},{"data":{"text":"四、预处理与数据集对象"},"children":[{"data":{"text":"分词与编码"},"children":[{"data":{"text":"tokenizer(text, padding, truncation, return_tensors)"},"children":[]},{"data":{"text":"生成：input_ids、attention_mask 等"},"children":[]}]},{"data":{"text":"构建数据集"},"children":[{"data":{"text":"使用 datasets.Dataset.map(tokenize_function) 批量处理"},"children":[]},{"data":{"text":"或自定义 torch.utils.data.Dataset"},"children":[]}]},{"data":{"text":"DataCollator"},"children":[{"data":{"text":"DataCollatorWithPadding：按当前批次动态 padding"},"children":[]}]}]},{"data":{"text":"五、训练配置 (TrainingArguments)"},"children":[{"data":{"text":"基本参数"},"children":[{"data":{"text":"output_dir：模型输出目录"},"children":[]},{"data":{"text":"num_train_epochs：训练轮数"},"children":[]},{"data":{"text":"per_device_train_batch_size、per_device_eval_batch_size"},"children":[]},{"data":{"text":"learning_rate：学习率"},"children":[]},{"data":{"text":"weight_decay：权重衰减"},"children":[]}]},{"data":{"text":"训练/评估策略"},"children":[{"data":{"text":"evaluation_strategy：如 \"epoch\"、\"steps\""},"children":[]},{"data":{"text":"logging_steps：多久打印一次日志"},"children":[]},{"data":{"text":"save_strategy：多久保存一次模型"},"children":[]}]},{"data":{"text":"其它"},"children":[{"data":{"text":"是否使用 fp16 混合精度"},"children":[]},{"data":{"text":"lr_scheduler_type：学习率调度器类型"},"children":[]}]}]},{"data":{"text":"六、Trainer 训练主干"},"children":[{"data":{"text":"创建 Trainer"},"children":[{"data":{"text":"传入：model、training_args"},"children":[]},{"data":{"text":"传入：train_dataset、eval_dataset"},"children":[]},{"data":{"text":"传入：tokenizer、data_collator"},"children":[]},{"data":{"text":"(可选) compute_metrics：计算 accuracy、F1 等"},"children":[]}]},{"data":{"text":"关键方法"},"children":[{"data":{"text":"trainer.train()：开始微调"},"children":[]},{"data":{"text":"trainer.evaluate()：在验证集上评估"},"children":[]},{"data":{"text":"trainer.save_model()：保存权重"},"children":[]}]}]},{"data":{"text":"七、评估与指标"},"children":[{"data":{"text":"常用指标"},"children":[{"data":{"text":"准确率 (accuracy)"},"children":[]},{"data":{"text":"精确率、召回率、F1 (尤其是不平衡数据)"},"children":[]}]},{"data":{"text":"评估方式"},"children":[{"data":{"text":"使用 evaluate 库 + compute_metrics 集成到 Trainer"},"children":[]},{"data":{"text":"或手动对预测结果计算指标"},"children":[]}]}]},{"data":{"text":"八、保存、加载与部署"},"children":[{"data":{"text":"保存"},"children":[{"data":{"text":"trainer.save_model() 保存模型与配置"},"children":[]},{"data":{"text":"tokenizer.save_pretrained(output_dir) 保存分词器"},"children":[]}]},{"data":{"text":"加载"},"children":[{"data":{"text":"AutoModelForSequenceClassification.from_pretrained(output_dir)"},"children":[]},{"data":{"text":"AutoTokenizer.from_pretrained(output_dir)"},"children":[]}]},{"data":{"text":"推理与部署"},"children":[{"data":{"text":"使用 pipeline(\"text-classification\", model=model, tokenizer=tokenizer) 推理"},"children":[]},{"data":{"text":"上传到 Hugging Face Hub (trainer.push_to_hub())"},"children":[]}]}]},{"data":{"text":"九、进阶：大模型微调 & 优化 (了解即可)"},"children":[{"data":{"text":"资源受限场景"},"children":[{"data":{"text":"使用 accelerate 做多卡/混合精度训练"},"children":[]},{"data":{"text":"参数高效微调 (PEFT/LoRA 等)"},"children":[{"data":{"text":"只训练少量新增参数，适合大模型"},"children":[]}]}]},{"data":{"text":"监控与调参"},"children":[{"data":{"text":"观察 loss 曲线与指标，调整 epoch、学习率、batch size"},"children":[]}]}]}]},"template":"filetree","theme":"fresh-blue","version":"1.4.43"}